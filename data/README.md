# Excel 文件说明

本目录存放应用导入所需的学生名单与单词列表示例。自 Phase 2.1.1 起，单词表支持更丰富的可选字段，但旧版仅“单词”一列的模板依然兼容。

## 学生名单模板

### 列要求

| 列名 | 必填 | 说明 |
| --- | --- | --- |
| 姓名 | 是 | 第一行为表头“姓名”，从第二行开始填写学生姓名。 |

- 仅保留这一列即可，其它临时列在导入时会被忽略。
- 请避免空行，系统会自动去除重复姓名。

### 示例

```
| 姓名 |
| ---- |
| 张三 |
| 李四 |
```

### 快捷生成

运行 `python create_sample_excel.py` 可批量生成示例班级名单。

## 单词列表模板

### 列定义

| 列名 | 必填 | 说明 |
| --- | --- | --- |
| 单词 | 是 | 抽选与展示使用的基础文本。 |
| 音标 | 否 | 支持任何格式，导入后用于闪卡正面。 |
| 释义 | 否 | 建议填写中文释义，可使用多行文本。 |
| 例句 | 否 | 示例句子或短语，支持多行文本。 |
| 标签 | 否 | 用于分组或筛选。可用中文/英文逗号、分号或换行分隔多个标签。 |
| 图片 | 否 | 本地图片路径或网络 URL。导入时会自动复制本地图片到 `assets/user/`。 |

> **兼容性提示**：只提供“单词”列的旧模板仍可导入，缺失字段会自动填充默认值。

### 示例

```
| 单词   | 音标      | 释义             | 例句                                      | 标签           | 图片 |
| apple  | /ˈæpl/    | n. 苹果；苹果树   | An apple a day keeps the doctor away.    | 水果,基础词汇  |     |
| lantern| /ˈlæntərn/| n. 灯笼；提灯      | We made a paper lantern for the festival.| 节日,手工制作  |     |
```

### 获取模板

- 运行 `python create_words_excel.py` 可重新生成 `单词列表.xlsx`。
- 应用内上传面板新增“模板示例”按钮，点击即可打开此文件（离线可用）。
- 也可以直接复制并修改本目录中的 `单词列表.xlsx`。

## 常见问题

### 1. 导入失败怎么办？

- 确认文件位于 `data/` 目录或通过上传面板选择。
- 检查表头是否包含必填列（“姓名”或“单词”）。
- 建议保存为 `.xlsx` 格式，并关闭其它占用该文件的程序。

### 2. 标签如何填写？

- 支持中文逗号 `，`、英文逗号 `,`、分号、竖线或换行分隔。
- 导入时会自动清理空白并去重，最终保存为标签数组。

### 3. 图片列有哪些注意事项？

- 支持绝对路径、相对路径以及 `http(s)` URL。
- 导入本地图片时，应用会复制到 `assets/user/` 目录并去重。
- 如果填写网络地址，离线模式下可能无法显示。
